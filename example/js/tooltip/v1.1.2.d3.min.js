(function(){function t(t,e,o){return function(){return(o||t)[e].apply(t,arguments)}}var e;window.Tooltip=e=function(){function e(e){var i;this.options=null!=e?e:{},this.onMouseMove=t(this,"onMouseMove",o),this.eventId="tooltip-"+n.counter++,null==(i=this.options).parent&&(i.parent=d3.select("body")),d3.select(document).on("mousemove."+this.eventId,t(this,"onMouseMove"))}e.displayName="Tooltip";var o=e.prototype,n=e;return e.counter=0,o.watchElements=function(){var e=this;return d3.select(document).on("mouseover."+this.eventId,function(){var t,o;return t=d3.event.target,o=t.getAttribute("data-tooltip"),o&&(o=unescape(o),o.length)?e.display(o):void 0}),d3.select(document).on("mouseout."+this.eventId,t(this,"hide"))},o.display=function(t){var e;return e=this.$element=this.options.parent.append("div"),e.attr("class","tooltip"),e.html(t),this.setPositionByMouse()},o.hide=function(){return this.$element?(this.$element.remove(),this.$element=null,this.mouseBound=!1):void 0},o.reposition=function(t){var e,o,n,i,s,u,l,r,h,d,a;return e=t[0],o=t[1],n=t[2],i=t[3],s=e-n,u=o-i,l=this.$element[0][0],r=l.offsetWidth,e-=r/2,h=(window.innerWidth||document.documentElement.clientWidth)-r,o-=l.offsetHeight,e=Math.max(s,e),e=Math.min(e,s+h),19+u>=o&&(d=-20,o+=l.offsetHeight-2*d),a=this.$element,a.style("left",e+"px"),a.style("top",o+"px"),a},o.setPositionByMouse=function(){return this.mouseBound=!0,this.lastMousePosition?this.reposition(this.lastMousePosition):void 0},o.onMouseMove=function(){var t;return t=d3.event,this.lastMousePosition=[t.pageX||t.clientX,t.pageY||t.clientY,t.clientX,t.clientY],this.mouseBound?this.reposition(this.lastMousePosition):void 0},e}()}).call(this);
